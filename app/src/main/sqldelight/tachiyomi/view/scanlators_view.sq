CREATE VIEW scanlators_view AS  -- Probably should migrate these to a real table
WITH split(seq, _id, name, str) AS (
    SELECT 0, M._id, NULL, replace(ifnull(M.filtered_scanlators, ''), ' & ', ',')||',' FROM mangas AS M
    UNION ALL SELECT
        seq+1,
        _id,
        substr(str, 0, instr(str, ',')),
        substr(str, instr(str, ',')+1)
    FROM split WHERE str != ''
) SELECT _id, name FROM split WHERE split.seq != 0 ORDER BY split.seq ASC;
